# 更新日志

## [2.0.0] - 2026-02-12

### 重大变更
- ⚠️ **WordPress 核心**: 升级到 6.9.1
- ⚠️ **AI 服务配置系统重构**: 移除所有硬编码端点，支持完全自定义
- ⚠️ **架构变更**: 引入提供商模式，支持多个AI服务商

### 新增功能
- ✨ **多 AI 提供商支持**
  - OpenAI (GPT-4, GPT-3.5-Turbo)
  - Claude (Anthropic) (Claude-3-Opus, Claude-3-Sonnet, Claude-3-Haiku)
  - 通义千问 (Qwen-Turbo, Qwen-Plus, Qwen-Max)
  - 文心一言 (ERNIE-Bot, ERNIE-Bot-Turbo)
  - 智谱AI (GLM-4, GLM-3-Turbo)
  - 自定义API (支持任何兼容OpenAI格式的端点)

- ✨ **完全自定义的 API 配置**
  - 自定义 API 端点地址
  - 自定义 API Key
  - 自定义模型名称
  - 支持多种认证方式 (Bearer Token, API Key, X-API-Key)
  - API Key 加密存储

- ✨ **提供商抽象层**
  - 统一的提供商接口
  - 可扩展的架构
  - 配置管理器
  - 连接测试功能

- ✨ **3D 图库增强**
  - 集成 Three.js 核心库 (0.160.0)
  - 添加 OBJLoader 和 OrbitControls
  - 改进资源加载顺序

### 改进
- 🎨 **AI 服务类重构**
  - 移除硬编码的 API 端点 (108、170、223、286行)
  - 使用提供商模式动态加载配置
  - 支持运行时切换提供商

- ⚡ **性能优化**
  - 优化 API 请求处理
  - 改进错误处理机制

- 🔒 **安全性增强**
  - API Key 加密存储 (AES-256-CBC)
  - 配置验证功能
  - 改进的输入验证

### Bug 修复
- 🐛 修复 AI 服务硬编码端点问题
- 🐛 修复配置管理中的潜在安全问题
- 🐛 改进错误消息和异常处理
- 🐛 **修复 v2.0.0 发布后的 PHP 语法错误**
  - xiaowu-ai.php 第 476 行缺少闭合括号
  - xiaowu-deployment.php 配置生成函数的模板语法问题
  - 重构为使用 heredoc 语法，提高代码可维护性

### 开发者相关
- 📝 新增提供商接口定义
- 📝 新增配置管理器类
- 📝 新增 OpenAI 提供商实现
- 📝 新增自定义提供商实现
- 📝 完善代码文档和注释

### 依赖更新
- WordPress 6.9 → 6.9.1
- Three.js → 0.160.0
- PHP 7.4 (保持兼容性)

### 升级指南
**重要**: 由于 AI 配置系统重构，升级后需要重新配置 AI 服务。

1. 进入 WordPress 后台 → 设置 → AI 服务
2. 选择您使用的 AI 提供商
3. 配置 API 端点（如使用自定义服务）
4. 配置 API Key
5. 测试连接

**迁移旧配置**:
旧的配置选项 `xiaowu_ai_provider`、`xiaowu_ai_api_key` 等仍然兼容，但建议使用新的配置界面。

### 已知问题
- 部署向导插件缺少管理界面（计划在后续版本中完善）
- 云盘集成功能待实现
- Three.js GLTFLoader 下载失败，需要手动安装

### 即将推出
- 完整的部署向导 UI
- 云盘集成（阿里云盘、百度网盘、OneDrive）
- AI 生图功能增强
- CDN 图库支持

---

## [1.0.0] - 2024-12-01

### 初始版本
- 基础 WordPress 博客功能
- AI 服务集成 (仅 OpenAI)
- 3D 图库基础功能
- 用户管理系统
- 评论系统
- 智能搜索功能
